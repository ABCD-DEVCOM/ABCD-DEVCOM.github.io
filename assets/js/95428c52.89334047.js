"use strict";(self.webpackChunkabcd_devcom_github_io=self.webpackChunkabcd_devcom_github_io||[]).push([[8161],{927:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"abcd-advanced/format-language/guide/conversion","title":"Data Conversion & Export","description":"Using PFT to generate CSV, XML, and other structured export formats.","source":"@site/docs/abcd-advanced/format-language/guide/conversion.md","sourceDirName":"abcd-advanced/format-language/guide","slug":"/abcd-advanced/format-language/guide/conversion","permalink":"/docs/3.1/abcd-advanced/format-language/guide/conversion","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/abcd-advanced/format-language/guide/conversion.md","tags":[],"version":"current","frontMatter":{"title":"Data Conversion & Export","description":"Using PFT to generate CSV, XML, and other structured export formats."},"sidebar":"tutorialSidebar","previous":{"title":"Guides & Tutorials","permalink":"/docs/3.1/category/guides--tutorials"},"next":{"title":"Sorting Records","permalink":"/docs/3.1/abcd-advanced/format-language/guide/sorting"}}');var a=r(74848),i=r(28453);const s={title:"Data Conversion & Export",description:"Using PFT to generate CSV, XML, and other structured export formats."},c="Data Conversion with PFT",o={},d=[{value:"1. Generating CSV (Comma Separated Values)",id:"1-generating-csv-comma-separated-values",level:2},{value:"Basic Structure",id:"basic-structure",level:3},{value:"Handling &quot;Dirty&quot; Data (Quoting)",id:"handling-dirty-data-quoting",level:3},{value:"Handling Repeatable Fields in CSV",id:"handling-repeatable-fields-in-csv",level:3},{value:"2. Generating XML",id:"2-generating-xml",level:2},{value:"XML Safety",id:"xml-safety",level:3},{value:"3. Generating JSON",id:"3-generating-json",level:2},{value:"4. Generating IDIF (ISO 2709 Text Representation)",id:"4-generating-idif-iso-2709-text-representation",level:2},{value:"5. Converting Character Sets",id:"5-converting-character-sets",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"data-conversion-with-pft",children:"Data Conversion with PFT"})}),"\n",(0,a.jsxs)(n.p,{children:["The Formatting Language is not just for screen display; it is a powerful ",(0,a.jsx)(n.strong,{children:"Report Generator"})," capable of transforming binary CISIS records into structured text formats like CSV, XML, JSON, or IDIF."]}),"\n",(0,a.jsx)(n.h2,{id:"1-generating-csv-comma-separated-values",children:"1. Generating CSV (Comma Separated Values)"}),"\n",(0,a.jsx)(n.p,{children:"Creating CSV files requires handling delimiters (commas or semicolons) and ensuring that data containing the delimiter is properly quoted."}),"\n",(0,a.jsx)(n.h3,{id:"basic-structure",children:"Basic Structure"}),"\n",(0,a.jsxs)(n.p,{children:["The goal is to produce one line per record, with fields separated by ",(0,a.jsx)(n.code,{children:";"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"/* Field 10 */\r\nv10, ';',\r\n/* Field 20 */\r\nv20, ';',\r\n/* Field 30 (Last field, no semicolon at the end) */\r\nv30\r\n/* Newline for next record */\r\n/\r\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"handling-dirty-data-quoting",children:'Handling "Dirty" Data (Quoting)'}),"\n",(0,a.jsxs)(n.p,{children:["If a title contains a semicolon (e.g., ",(0,a.jsx)(n.code,{children:"History; A Novel"}),"), the simple format above breaks the CSV. You must wrap fields in quotes."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"'\"', v10, '\"', ';',\r\n'\"', v20, '\"'\r\n/\r\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"Advanced:"})," If the data ",(0,a.jsx)(n.em,{children:"also"})," contains quotes, standard CSV requires escaping them (double quotes ",(0,a.jsx)(n.code,{children:'""'}),"). PFT's ",(0,a.jsx)(n.code,{children:"replace"})," function can handle this:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"'\"', replace(v10, '\"', '\"\"'), '\"', ';', ...\r\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"handling-repeatable-fields-in-csv",children:"Handling Repeatable Fields in CSV"}),"\n",(0,a.jsx)(n.p,{children:"CSV is flat (2D). Repeatable fields (3D) can be handled in two ways:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Concatenation:"})," Join all occurrences with a different separator (e.g., ",(0,a.jsx)(n.code,{children:"|"}),")."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"'\"', (v70 + | \\| |), '\"', ';'\r\n\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Explosion:"})," Generate multiple lines per record (one per author)."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"(\r\n   v10, ';', v70, /\r\n)\r\n\n"})}),"\n",(0,a.jsx)(n.h2,{id:"2-generating-xml",children:"2. Generating XML"}),"\n",(0,a.jsx)(n.p,{children:"XML generation is straightforward with PFT because you can output tags directly as literals."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"'<record>', /\r\n   '<mfn>', f(mfn, 0, 0), '</mfn>', /\r\n   \r\n   /* Title */\r\n   if p(v24) then\r\n      '<title>', v24, '</title>', /\r\n   fi,\r\n   \r\n   /* Authors (Repeatable) */\r\n   (\r\n      '<creator>', v70, '</creator>', /\r\n   ),\r\n   \r\n'</record>', /\r\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"xml-safety",children:"XML Safety"}),"\n",(0,a.jsxs)(n.p,{children:["You must ensure special characters (",(0,a.jsx)(n.code,{children:"<"}),", ",(0,a.jsx)(n.code,{children:">"}),", ",(0,a.jsx)(n.code,{children:"&"}),") in your data do not break the XML structure."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"CDatas:"})," Wrap content in CDATA sections."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"'<title><![CDATA[', v24, ']]></title>'\r\n\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"HTML Encoding:"})," Use a lookup table or ",(0,a.jsx)(n.code,{children:"replace"})," to convert ",(0,a.jsx)(n.code,{children:"&"})," to ",(0,a.jsx)(n.code,{children:"&amp;"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"3-generating-json",children:"3. Generating JSON"}),"\n",(0,a.jsxs)(n.p,{children:["JSON requires strict comma placement (no comma after the last item). This is tricky in PFT but solvable using the ",(0,a.jsx)(n.code,{children:"size"})," or ",(0,a.jsx)(n.code,{children:"nocc"})," checks, or by using the ",(0,a.jsx)(n.code,{children:"+"})," conditional suffix effectively."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Example: Simple Record to JSON"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"'{', /\r\n   '\"mfn\": ', f(mfn,0,0), ',', /\r\n   '\"title\": \"', v24, '\"',\r\n   \r\n   /* Authors Array */\r\n   if p(v70) then\r\n      ', \"authors\": [', /\r\n      (\r\n         '\"', v70, '\"',\r\n         if iocc < nocc(v70) then ', ' fi\r\n      )\r\n      ']'\r\n   fi\r\n   \r\n'}', /\r\n\n"})}),"\n",(0,a.jsx)(n.h2,{id:"4-generating-idif-iso-2709-text-representation",children:"4. Generating IDIF (ISO 2709 Text Representation)"}),"\n",(0,a.jsxs)(n.p,{children:["IDIF is a text-based format used by CISIS to represent the structure of an ISO-2709 file. It is often used for data migration (",(0,a.jsx)(n.code,{children:"id2i"}),")."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Format:"}),"\r\n",(0,a.jsx)(n.code,{children:"!ID MFN"}),"\r\n",(0,a.jsx)(n.code,{children:"!vTAG!Field Content"})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"PFT Script:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"/* Record Header */\r\n'!ID ', f(mfn, 6, 0), /\r\n\r\n/* Iterate through all fields (if you know the tags) */\r\n(\r\n   if p(v10) then '!v010!', v10, / fi\r\n),\r\n(\r\n   if p(v70) then '!v070!', v70, / fi\r\n)\r\n\n"})}),"\n",(0,a.jsx)(n.h2,{id:"5-converting-character-sets",children:"5. Converting Character Sets"}),"\n",(0,a.jsxs)(n.p,{children:["*See also: ",(0,a.jsx)(n.a,{href:"https://www.google.com/search?q=../reference/system-data",children:"System Commands"})," for ",(0,a.jsx)(n.code,{children:"proc*"})]}),"\n",(0,a.jsxs)(n.p,{children:["When exporting, you may need to convert from ANSI to UTF-8 or vice-versa. While ",(0,a.jsx)(n.code,{children:"mx"})," handles this with ",(0,a.jsx)(n.code,{children:"-gi"}),"/",(0,a.jsx)(n.code,{children:"-go"})," parameters, PFT can do simple replacements if needed."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pft",children:"/* Replace accented 'a' with HTML entity */\r\nreplace(v10, '\xe1', '&aacute;')\r\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>c});var t=r(96540);const a={},i=t.createContext(a);function s(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);