"use strict";(self.webpackChunkabcd_devcom_github_io=self.webpackChunkabcd_devcom_github_io||[]).push([[7525],{23612:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"abcd-advanced/format-language/guide/validation","title":"Data Validation","description":"Using PFT to validate input data and enforce integrity rules.","source":"@site/versioned_docs/version-2.0/abcd-advanced/format-language/guide/validation.md","sourceDirName":"abcd-advanced/format-language/guide","slug":"/abcd-advanced/format-language/guide/validation","permalink":"/docs/2.0/abcd-advanced/format-language/guide/validation","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/versioned_docs/version-2.0/abcd-advanced/format-language/guide/validation.md","tags":[],"version":"2.0","frontMatter":{"title":"Data Validation","description":"Using PFT to validate input data and enforce integrity rules."},"sidebar":"tutorialSidebar","previous":{"title":"Field & Subfield Selection","permalink":"/docs/2.0/abcd-advanced/format-language/guide/subfields"},"next":{"title":"Command Reference","permalink":"/docs/2.0/category/command-reference-1"}}');var r=i(74848),t=i(28453);const s={title:"Data Validation",description:"Using PFT to validate input data and enforce integrity rules."},d="Data Validation with PFT",l={},o=[{value:"The Concept",id:"the-concept",level:2},{value:"Data Entry Mode",id:"data-entry-mode",level:2},{value:"Common Validation Scenarios",id:"common-validation-scenarios",level:2},{value:"1. Mandatory Fields",id:"1-mandatory-fields",level:3},{value:"2. Conditional Mandatoriness",id:"2-conditional-mandatoriness",level:3},{value:"3. Validating Repeatable Groups",id:"3-validating-repeatable-groups",level:3},{value:"4. Duplicate Checking",id:"4-duplicate-checking",level:3},{value:"5. Format/Pattern Validation",id:"5-formatpattern-validation",level:3},{value:"6. Value Lists (Controlled Vocabulary)",id:"6-value-lists-controlled-vocabulary",level:3},{value:"Integration in ABCD",id:"integration-in-abcd",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"data-validation-with-pft",children:"Data Validation with PFT"})}),"\n",(0,r.jsxs)(n.p,{children:["In ABCD and CISIS databases, data integrity is enforced using ",(0,r.jsx)(n.strong,{children:"Validation Formats"}),". Unlike standard display formats, these are executed during data entry (when creating or updating a record)."]}),"\n",(0,r.jsx)(n.h2,{id:"the-concept",children:"The Concept"}),"\n",(0,r.jsxs)(n.p,{children:["The validation logic works on a simple principle: ",(0,r.jsx)(n.strong,{children:'"Silence is Success"'}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If the PFT executes and produces ",(0,r.jsx)(n.strong,{children:"no output"})," (empty string), the record is considered ",(0,r.jsx)(n.strong,{children:"Valid"})," and gets saved."]}),"\n",(0,r.jsxs)(n.li,{children:["If the PFT produces ",(0,r.jsx)(n.strong,{children:"any output"})," (text), that output is treated as an ",(0,r.jsx)(n.strong,{children:"Error Message"}),", displayed to the user, and the save operation is blocked."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"data-entry-mode",children:"Data Entry Mode"}),"\n",(0,r.jsxs)(n.p,{children:["When a PFT is executed for validation, the system runs in ",(0,r.jsx)(n.strong,{children:"Data Entry Mode"}),". This has specific implications for how subfields and delimiters are handled compared to the standard Proof Mode."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subfields:"})," In validation, you often need to check specific subfields (e.g., ",(0,r.jsx)(n.code,{children:"v10^a"}),") rather than the whole field."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Repetitions:"})," Validation often iterates through repeatable fields to ensure ",(0,r.jsx)(n.em,{children:"every"})," occurrence meets the criteria."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-validation-scenarios",children:"Common Validation Scenarios"}),"\n",(0,r.jsx)(n.h3,{id:"1-mandatory-fields",children:"1. Mandatory Fields"}),"\n",(0,r.jsx)(n.p,{children:"To ensure a field (e.g., Tag 10 - Title) is not empty."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-pft",children:"/* If Tag 10 is absent, display error */\r\nif a(v10) then 'Error: Title is mandatory!' fi\r\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-conditional-mandatoriness",children:"2. Conditional Mandatoriness"}),"\n",(0,r.jsxs)(n.p,{children:["A field is required only if another field has a specific value.\r\n",(0,r.jsx)(n.em,{children:"Example:"}),' If "Publication Type" (v20) is "Article", then "Source Journal" (v30) is required.']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-pft",children:"if v20 = 'Article' and a(v30) then\r\n   'Error: Source Journal is required for Articles.'\r\nfi\r\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-validating-repeatable-groups",children:"3. Validating Repeatable Groups"}),"\n",(0,r.jsxs)(n.p,{children:["If a field is repeatable (e.g., Authors in Tag 70), you must ensure ",(0,r.jsx)(n.em,{children:"all"})," authors have a valid format. You iterate through them using a repeatable group."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-pft",children:"(\r\n   if p(v70) and size(v70) < 3 then\r\n      'Error: Author name \"' v70 '\" is too short.' /\r\n   fi\r\n)\r\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Note:"})," The ",(0,r.jsx)(n.code,{children:"/"})," ensures that if multiple authors are invalid, each error appears on a new line."]}),"\n",(0,r.jsx)(n.h3,{id:"4-duplicate-checking",children:"4. Duplicate Checking"}),"\n",(0,r.jsx)(n.p,{children:"To prevent duplicate records (e.g., ensuring ISBN in Tag 20 is unique)."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Technique:"})," Use the ",(0,r.jsx)(n.code,{children:"l()"})," lookup function to see if the term already exists in the inverted file."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Constraint:"}),' You must exclude the current record from the check (otherwise, editing an existing record would trigger a "duplicate" error against itself).']}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-pft",children:"/* v20 is ISBN. \"ISBN_\" is the prefix in FST */\r\nif p(v20) then\r\n   /* Find MFN of record containing this ISBN */\r\n   proc('a9999~' l('ISBN_' v20) '~'),\r\n   \r\n   /* If found (val > 0) AND it is not the current record (mfn) */\r\n   if val(v9999) > 0 and val(v9999) <> mfn then\r\n      'Error: ISBN ' v20 ' already exists in record ' v9999\r\n   fi\r\nfi\r\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-formatpattern-validation",children:"5. Format/Pattern Validation"}),"\n",(0,r.jsx)(n.p,{children:"Checking if a field follows a specific pattern (e.g., Year must be 4 digits)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-pft",children:"if p(v64) then\r\n   if val(v64) < 1000 or val(v64) > 3000 then\r\n      'Error: Invalid Year ' v64\r\n   fi\r\nfi\r\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"6-value-lists-controlled-vocabulary",children:"6. Value Lists (Controlled Vocabulary)"}),"\n",(0,r.jsx)(n.p,{children:"Ensuring a field contains one of the allowed values."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-pft",children:"if p(v40) then\r\n   if v40 <> 'ENG' and v40 <> 'SPA' and v40 <> 'POR' then\r\n      'Error: Language ' v40 ' is not valid (Use ENG, SPA, POR).'\r\n   fi\r\nfi\r\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Tip:"})," For long lists, it is more efficient to use a ",(0,r.jsx)(n.code,{children:"ref()"})," to a thesaurus database or ",(0,r.jsx)(n.code,{children:"select"})," case structure."]}),"\n",(0,r.jsx)(n.h2,{id:"integration-in-abcd",children:"Integration in ABCD"}),"\n",(0,r.jsxs)(n.p,{children:["In ABCD, these validation scripts are typically saved as ",(0,r.jsx)(n.code,{children:".val"})," files in the database directory (e.g., ",(0,r.jsx)(n.code,{children:"bases/marc/def/en/marc.val"}),") or configured in the ",(0,r.jsx)(n.strong,{children:"Advanced Editing"})," parameters."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>d});var a=i(96540);const r={},t=a.createContext(r);function s(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);